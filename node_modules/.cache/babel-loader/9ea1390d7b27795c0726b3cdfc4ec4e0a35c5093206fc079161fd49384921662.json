{"ast":null,"code":"// src/services/roomService.js\n\nconst STORAGE_KEY = 'crypto_race_rooms';\nconst getRooms = () => {\n  const rooms = localStorage.getItem(STORAGE_KEY);\n  return rooms ? JSON.parse(rooms) : {};\n};\nconst saveRooms = rooms => {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(rooms));\n};\nexport const createRoom = (roomCode, playerName, selectedCrypto) => {\n  const rooms = getRooms();\n  rooms[roomCode] = {\n    players: [{\n      name: playerName,\n      prediction: null\n    }],\n    selectedCrypto: selectedCrypto,\n    started: false,\n    winner: null\n  };\n  saveRooms(rooms);\n};\nexport const joinRoom = (roomCode, playerName) => {\n  const rooms = getRooms();\n  if (rooms[roomCode] && !rooms[roomCode].started) {\n    rooms[roomCode].players.push({\n      name: playerName,\n      prediction: null\n    });\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const getRoomPlayers = roomCode => {\n  const rooms = getRooms();\n  return rooms[roomCode] ? rooms[roomCode].players : null;\n};\nexport const getRoomData = roomCode => {\n  const rooms = getRooms();\n  return rooms[roomCode] || null;\n};\nexport const updatePlayerPrediction = (roomCode, playerName, prediction) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    const playerIndex = rooms[roomCode].players.findIndex(p => p.name === playerName);\n    if (playerIndex !== -1) {\n      rooms[roomCode].players[playerIndex].prediction = prediction;\n      saveRooms(rooms);\n      return true;\n    }\n  }\n  return false;\n};\nexport const startRace = roomCode => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].started = true;\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const updateWinner = (roomCode, winnerName) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].winner = winnerName;\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const fetchCryptocurrencies = async () => {\n  try {\n    const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false');\n    const data = await response.json();\n    return data.map(crypto => ({\n      id: crypto.id,\n      name: crypto.name,\n      symbol: crypto.symbol,\n      image: crypto.image\n    }));\n  } catch (error) {\n    console.error('Error fetching cryptocurrencies:', error);\n    return [];\n  }\n};\nexport const isRoomFull = roomCode => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    // You can set a maximum number of players per room here\n    const MAX_PLAYERS = 10;\n    return rooms[roomCode].players.length >= MAX_PLAYERS;\n  }\n  return false;\n};\nexport const deleteRoom = roomCode => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    delete rooms[roomCode];\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const leaveRoom = (roomCode, playerName) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].players = rooms[roomCode].players.filter(p => p.name !== playerName);\n    if (rooms[roomCode].players.length === 0) {\n      delete rooms[roomCode];\n    }\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};","map":{"version":3,"names":["STORAGE_KEY","getRooms","rooms","localStorage","getItem","JSON","parse","saveRooms","setItem","stringify","createRoom","roomCode","playerName","selectedCrypto","players","name","prediction","started","winner","joinRoom","push","getRoomPlayers","getRoomData","updatePlayerPrediction","playerIndex","findIndex","p","startRace","updateWinner","winnerName","fetchCryptocurrencies","response","fetch","data","json","map","crypto","id","symbol","image","error","console","isRoomFull","MAX_PLAYERS","length","deleteRoom","leaveRoom","filter"],"sources":["F:/crypto-chicken-run/src/services/roomService.js"],"sourcesContent":["// src/services/roomService.js\r\n\r\nconst STORAGE_KEY = 'crypto_race_rooms';\r\n\r\nconst getRooms = () => {\r\n  const rooms = localStorage.getItem(STORAGE_KEY);\r\n  return rooms ? JSON.parse(rooms) : {};\r\n};\r\n\r\nconst saveRooms = (rooms) => {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(rooms));\r\n};\r\n\r\nexport const createRoom = (roomCode, playerName, selectedCrypto) => {\r\n  const rooms = getRooms();\r\n  rooms[roomCode] = { \r\n    players: [{ name: playerName, prediction: null }],\r\n    selectedCrypto: selectedCrypto,\r\n    started: false,\r\n    winner: null\r\n  };\r\n  saveRooms(rooms);\r\n};\r\n\r\nexport const joinRoom = (roomCode, playerName) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode] && !rooms[roomCode].started) {\r\n    rooms[roomCode].players.push({ name: playerName, prediction: null });\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getRoomPlayers = (roomCode) => {\r\n  const rooms = getRooms();\r\n  return rooms[roomCode] ? rooms[roomCode].players : null;\r\n};\r\n\r\nexport const getRoomData = (roomCode) => {\r\n  const rooms = getRooms();\r\n  return rooms[roomCode] || null;\r\n};\r\n\r\nexport const updatePlayerPrediction = (roomCode, playerName, prediction) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    const playerIndex = rooms[roomCode].players.findIndex(p => p.name === playerName);\r\n    if (playerIndex !== -1) {\r\n      rooms[roomCode].players[playerIndex].prediction = prediction;\r\n      saveRooms(rooms);\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const startRace = (roomCode) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].started = true;\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const updateWinner = (roomCode, winnerName) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].winner = winnerName;\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const fetchCryptocurrencies = async () => {\r\n  try {\r\n    const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false');\r\n    const data = await response.json();\r\n    return data.map(crypto => ({\r\n      id: crypto.id,\r\n      name: crypto.name,\r\n      symbol: crypto.symbol,\r\n      image: crypto.image,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching cryptocurrencies:', error);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const isRoomFull = (roomCode) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    // You can set a maximum number of players per room here\r\n    const MAX_PLAYERS = 10;\r\n    return rooms[roomCode].players.length >= MAX_PLAYERS;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const deleteRoom = (roomCode) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    delete rooms[roomCode];\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const leaveRoom = (roomCode, playerName) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].players = rooms[roomCode].players.filter(p => p.name !== playerName);\r\n    if (rooms[roomCode].players.length === 0) {\r\n      delete rooms[roomCode];\r\n    }\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}