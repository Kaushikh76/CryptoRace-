{"ast":null,"code":"// src/services/roomService.js\n\nconst STORAGE_KEY = 'crypto_race_rooms';\nconst getRooms = () => {\n  const rooms = localStorage.getItem(STORAGE_KEY);\n  return rooms ? JSON.parse(rooms) : {};\n};\nconst saveRooms = rooms => {\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(rooms));\n};\nexport const createRoom = (roomCode, playerName, selectedCrypto) => {\n  const rooms = getRooms();\n  rooms[roomCode] = {\n    players: [{\n      name: playerName,\n      prediction: null\n    }],\n    selectedCrypto: selectedCrypto,\n    started: false,\n    winner: null,\n    startTime: null,\n    priceData: []\n  };\n  saveRooms(rooms);\n};\nexport const joinRoom = (roomCode, playerName) => {\n  const rooms = getRooms();\n  if (rooms[roomCode] && !rooms[roomCode].started) {\n    rooms[roomCode].players.push({\n      name: playerName,\n      prediction: null\n    });\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const getRoomPlayers = roomCode => {\n  const rooms = getRooms();\n  return rooms[roomCode] ? rooms[roomCode].players : null;\n};\nexport const getRoomData = roomCode => {\n  const rooms = getRooms();\n  return rooms[roomCode] || null;\n};\nexport const updatePlayerPrediction = (roomCode, playerName, prediction) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    const playerIndex = rooms[roomCode].players.findIndex(p => p.name === playerName);\n    if (playerIndex !== -1) {\n      rooms[roomCode].players[playerIndex].prediction = prediction;\n      saveRooms(rooms);\n      return true;\n    }\n  }\n  return false;\n};\nexport const startRace = (roomCode, startTime, initialPriceData) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].started = true;\n    rooms[roomCode].startTime = startTime.toISOString();\n    rooms[roomCode].priceData = initialPriceData;\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const updateRaceData = (roomCode, priceData) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].priceData = priceData;\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const updateWinner = (roomCode, winnerName) => {\n  const rooms = getRooms();\n  if (rooms[roomCode]) {\n    rooms[roomCode].winner = winnerName;\n    saveRooms(rooms);\n    return true;\n  }\n  return false;\n};\nexport const fetchCryptocurrencies = async () => {\n  try {\n    const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false');\n    const data = await response.json();\n    return data.map(crypto => ({\n      id: crypto.id,\n      name: crypto.name,\n      symbol: crypto.symbol,\n      image: crypto.image\n    }));\n  } catch (error) {\n    console.error('Error fetching cryptocurrencies:', error);\n    return [];\n  }\n};","map":{"version":3,"names":["STORAGE_KEY","getRooms","rooms","localStorage","getItem","JSON","parse","saveRooms","setItem","stringify","createRoom","roomCode","playerName","selectedCrypto","players","name","prediction","started","winner","startTime","priceData","joinRoom","push","getRoomPlayers","getRoomData","updatePlayerPrediction","playerIndex","findIndex","p","startRace","initialPriceData","toISOString","updateRaceData","updateWinner","winnerName","fetchCryptocurrencies","response","fetch","data","json","map","crypto","id","symbol","image","error","console"],"sources":["F:/crypto-chicken-run/src/services/roomService.js"],"sourcesContent":["// src/services/roomService.js\r\n\r\nconst STORAGE_KEY = 'crypto_race_rooms';\r\n\r\nconst getRooms = () => {\r\n  const rooms = localStorage.getItem(STORAGE_KEY);\r\n  return rooms ? JSON.parse(rooms) : {};\r\n};\r\n\r\nconst saveRooms = (rooms) => {\r\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(rooms));\r\n};\r\n\r\nexport const createRoom = (roomCode, playerName, selectedCrypto) => {\r\n  const rooms = getRooms();\r\n  rooms[roomCode] = { \r\n    players: [{ name: playerName, prediction: null }],\r\n    selectedCrypto: selectedCrypto,\r\n    started: false,\r\n    winner: null,\r\n    startTime: null,\r\n    priceData: []\r\n  };\r\n  saveRooms(rooms);\r\n};\r\n\r\nexport const joinRoom = (roomCode, playerName) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode] && !rooms[roomCode].started) {\r\n    rooms[roomCode].players.push({ name: playerName, prediction: null });\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const getRoomPlayers = (roomCode) => {\r\n  const rooms = getRooms();\r\n  return rooms[roomCode] ? rooms[roomCode].players : null;\r\n};\r\n\r\nexport const getRoomData = (roomCode) => {\r\n  const rooms = getRooms();\r\n  return rooms[roomCode] || null;\r\n};\r\n\r\nexport const updatePlayerPrediction = (roomCode, playerName, prediction) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    const playerIndex = rooms[roomCode].players.findIndex(p => p.name === playerName);\r\n    if (playerIndex !== -1) {\r\n      rooms[roomCode].players[playerIndex].prediction = prediction;\r\n      saveRooms(rooms);\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const startRace = (roomCode, startTime, initialPriceData) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].started = true;\r\n    rooms[roomCode].startTime = startTime.toISOString();\r\n    rooms[roomCode].priceData = initialPriceData;\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const updateRaceData = (roomCode, priceData) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].priceData = priceData;\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const updateWinner = (roomCode, winnerName) => {\r\n  const rooms = getRooms();\r\n  if (rooms[roomCode]) {\r\n    rooms[roomCode].winner = winnerName;\r\n    saveRooms(rooms);\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n\r\nexport const fetchCryptocurrencies = async () => {\r\n  try {\r\n    const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=100&page=1&sparkline=false');\r\n    const data = await response.json();\r\n    return data.map(crypto => ({\r\n      id: crypto.id,\r\n      name: crypto.name,\r\n      symbol: crypto.symbol,\r\n      image: crypto.image,\r\n    }));\r\n  } catch (error) {\r\n    console.error('Error fetching cryptocurrencies:', error);\r\n    return [];\r\n  }\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}